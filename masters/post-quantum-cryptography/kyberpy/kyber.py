from ntt import ntt, ntt_inverse, ntt_multiply_polynomial_vectors
from utility import Nonce, reduce
from parameters import PARAMETERS
from extendedeuclidian import moduloInverse
from operator import add

import A as _A
from symetricprimitives import G as _G
from symetricprimitives.PRF import PRF
from symetricprimitives.CBD import CBD


def key_generation():
    public_seed, noise_seed = _G.generate_seed()
    A = _A.generate(public_seed)

    nonce = Nonce(0)
    secret_key = [CBD(PARAMETERS.eta1, PRF(PARAMETERS.eta1, noise_seed, nonce.next())) for _ in range(PARAMETERS.k)]
    error = [CBD(PARAMETERS.eta1, PRF(PARAMETERS.eta1, noise_seed, nonce.next())) for _ in range(PARAMETERS.k)]

    secret_key_ntt = [reduce(ntt(k), PARAMETERS.q) for k in secret_key]
    error_ntt = [reduce(ntt(k), PARAMETERS.q) for k in error]

    public_key = [ntt_multiply_polynomial_vectors(a, secret_key_ntt) for a in A]
    public_key = [reduce(list(map(add, public, error)), PARAMETERS.q) for (public, error) in zip(public_key, error_ntt)]


trt = [[769, 555, 1057, 291, 2418, 450, 1710, 2631, 2755, 3006, 1584, 2135, 608, 2300, 1238, 950, 2335, 2138, 1564, 546, 3253, 1734, 2539, 2954, 2566, 2698, 1661, 797, 2169, 993, 1079, 1966, 1555, 3182, 1664, 429, 2570, 1172, 2479, 2402, 1447, 2674, 749, 3198, 1023, 620, 105, 1224, 1099, 2926, 1286, 1759, 2925, 1858, 543, 1542, 2340, 53, 3198, 3182, 2092, 2454, 2215, 1238, 2246, 1200, 1288, 1500, 1475, 1317, 866, 2438, 3183, 2619, 3173, 400, 3260, 1901, 1376, 49, 1296, 385, 152, 2417, 2813, 1209, 232, 350, 2937, 786, 101, 1493, 1417, 757, 1981, 2076, 168, 2337, 105, 2069, 2010, 395, 2329, 1102, 1765, 214, 710, 204, 2231, 728, 904, 717, 1997, 3133, 2669, 2718, 547, 2440, 2262, 531, 2627, 1596, 3119, 9, 2758, 55, 1428, 2726, 178, 2943, 1415, 710, 665, 2659, 1874, 488, 3143, 1305, 3308, 113, 3321, 2445, 3158, 377, 3, 1605, 2780, 870, 2815, 3003, 2883, 1205, 2726, 1596, 2497, 2422, 1938, 2803, 1425, 653, 537, 149, 418, 2501, 3115, 787, 427, 2295, 1989, 2575, 2605, 1241, 1300, 2612, 2939, 2417, 267, 2129, 2956, 3003, 3089, 2196, 2145, 3110, 3165, 1002, 1056, 2076, 2556, 1306, 308, 2386, 2872, 1013, 2590, 721, 599, 726, 3220, 882, 963, 1380, 2122, 2559, 106, 2635, 644, 1578, 1019, 2596, 2844, 47, 2700, 2253, 2197, 1172, 3319, 1720, 818, 1715, 2809, 2691, 1371, 1724, 2157, 1608, 2800, 3092, 563, 2903, 236, 84, 194, 68, 2368, 3289, 521, 2617, 720, 3024, 720, 2825, 1924, 2256, 3173, 2112, 887, 1936, 2662, 195, 458, 1581, 1396, 2378, 1647, 2483, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [2590, 2723, 2049, 874, 2203, 1325, 1388, 3018, 927, 2315, 180, 2669, 1072, 3233, 3115, 1134, 190, 2833, 3265, 1696, 1153, 81, 3296, 2312, 1756, 2985, 2754, 44, 880, 1849, 167, 3026, 980, 1554, 149, 2804, 0, 386, 108, 3021, 685, 3191, 2678, 785, 1706, 2587, 161, 2945, 3114, 1607, 1323, 660, 2039, 64, 2108, 135, 3000, 1259, 585, 682, 2285, 474, 1546, 2247, 2902, 1318, 316, 3197, 474, 590, 3131, 619, 853, 1075, 1630, 2335, 1556, 1563, 1187, 1076, 2263, 741, 1018, 1611, 2068, 277, 2612, 28, 2577, 111, 1530, 1074, 2540, 1336, 2319, 635, 2952, 1444, 2919, 2771, 2764, 687, 3146, 1546, 1450, 83, 2388, 2968, 707, 3259, 1432, 2528, 1692, 1983, 1189, 3267, 558, 1134, 2956, 396, 2101, 156, 299, 1844, 2511, 1310, 2849, 1764, 2642, 2587, 920, 240, 1049, 3106, 1225, 1169, 709, 301, 2125, 3081, 2371, 1455, 408, 2062, 3266, 2548, 2924, 3250, 3257, 208, 283, 1907, 1076, 1900, 1084, 50, 2129, 1070, 3268, 2318, 2936, 115, 2095, 3197, 2115, 135, 3144, 369, 639, 2551, 2155, 2994, 3038, 2535, 1575, 2410, 1293, 888, 3219, 935, 2070, 1695, 3303, 2783, 1788, 2702, 3077, 2212, 2321, 2842, 1549, 1590, 790, 2130, 2045, 1269, 2815, 2773, 2177, 479, 406, 2187, 930, 1047, 1740, 240, 1497, 797, 837, 109, 1721, 3181, 1996, 1339, 3028, 2342, 333, 2796, 1032, 454, 2484, 1668, 2980, 1, 138, 1629, 1588, 3148, 1312, 503, 2533, 1882, 1595, 681, 1654, 2360, 520, 1913, 3018, 974, 3202, 2789, 2530, 544, 2693, 1573, 2251, 768, 3012, 1650, 679, 428, 1720, 2275, 2503, 417, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

z = [1028, 1252, 299, 711, 3213, 231, 1392, 1871, 1674, 3008, 2209, 2522, 2680, 2677, 2357, 2699, 1282, 1951, 3023, 2985, 3196, 513, 883, 2321, 293, 706, 1143, 966, 2808, 342, 547, 3158, 2275, 1505, 579, 1571, 426, 1801, 1161, 2146, 2085, 1152, 610, 1245, 1204, 200, 1978, 2063, 2407, 1962, 368, 2435, 974, 1638, 2174, 2220, 1061, 53, 2667, 1465, 3159, 2859, 2757, 269, 2813, 498, 13, 1778, 1001, 452, 2628, 1389, 2838, 1739, 1072, 447, 1825, 380, 2826, 1266, 490, 2875, 151, 2722, 987, 944, 1233, 608, 74, 514, 260, 2592, 2833, 2232, 2255, 819, 3009, 2951, 1321, 2505, 250, 1533, 136, 1382, 2142, 1064, 709, 1234, 910, 2020, 2926, 1191, 488, 3009, 2711, 929, 769, 2323, 1392, 3030, 1743, 2365, 1770, 2407, 2765, 1065, 353, 2234, 2965, 1844, 51, 2876, 2292, 768, 282, 2163, 675, 765, 2706, 3157, 3213, 1091, 1611, 311, 85, 2427, 2712, 1469, 1126, 1468, 1857, 1939, 2235, 1661, 2154, 1097, 498, 1102, 636, 1245, 1699, 1102, 1985, 1158, 1917, 588, 2255, 3154, 195, 1042, 1050, 909, 91, 2633, 8, 193, 2814, 2076, 415, 1840, 266, 2449, 1486, 223, 21, 1112, 1903, 1673, 3292, 2344, 1960, 2887, 707, 2541, 133, 3028, 2977, 368, 274, 86, 3209, 620, 3024, 3311, 945, 423, 1567, 1354, 2150, 2765, 440, 2707, 2112, 1203, 3204, 968, 596, 360, 23, 1801, 650, 734, 2226, 3114, 464, 986, 709, 801, 1172, 2669, 134, 1350, 105, 2257, 2688, 571, 1361, 630, 2269, 936, 2924, 696, 252, 1876, 3135, 1654, 1086, 2602, 2617, 602, 2007, 2739, 2733, 2912, 1330, 2102]
y = [
    [2782, 3155, 1720, 2464, 2319, 2918, 2433, 2990, 36, 983, 817, 1490, 1087, 2338, 2509, 242, 2417, 1687, 1723, 2564, 2777, 680, 2497, 2007, 941, 2951, 325, 182, 2613, 1956, 2055, 1489, 1132, 334, 522, 1539, 94, 1504, 1886, 2378, 698, 1375, 359, 275, 597, 1875, 237, 480, 1149, 1278, 2332, 1212, 2322, 1055, 2367, 1388, 526, 1261, 275, 334, 3105, 1354, 1195, 2509, 2121, 2233, 244, 1959, 1427, 3258, 1384, 1413, 2619, 2202, 3072, 1854, 2127, 2769, 1584, 2108, 1879, 869, 1104, 34, 2735, 2824, 809, 790, 3110, 1679, 1084, 2609, 2057, 1994, 2474, 3164, 1045, 329, 237, 485, 2159, 416, 2023, 1346, 1606, 2956, 1127, 80, 1136, 2309, 1660, 477, 2415, 1555, 3266, 2045, 1520, 2654, 2062, 1579, 508, 1605, 2855, 591, 233, 2502, 560, 351, 592, 175, 816, 1127, 1501, 390, 996, 3194, 1102, 2470, 1950, 1872, 1694, 763, 2087, 2563, 197, 2196, 568, 537, 647, 786, 2893, 342, 351, 1605, 3068, 1472, 760, 3188, 363, 713, 1973, 907, 3036, 2221, 373, 635, 298, 900, 780, 1532, 173, 2706, 1032, 2852, 1022, 34, 888, 1096, 3248, 786, 885, 1057, 1037, 2264, 1437, 2547, 2764, 3164, 1394, 1426, 1361, 2437, 1061, 1050, 2517, 2959, 496, 1068, 610, 1325, 3315, 737, 1746, 1591, 2522, 2143, 122, 423, 1444, 2911, 332, 867, 863, 1471, 13, 1504, 453, 1980, 1561, 542, 253, 272, 146, 1133, 1825, 2393, 2991, 1082, 1461, 1987, 3291, 2187, 533, 2246, 1255, 1812, 2032, 961, 674, 2165, 674, 194, 2060, 1668, 3072, 2199, 2763, 2848, 587, 2818, 1224, 620, 678, 802, 1625, 1039],
    [2517, 154, 1391, 3019, 407, 1564, 2372, 1771, 951, 3323, 1833, 3266, 2705, 354, 373, 1228, 1380, 1829, 236, 404, 1366, 1990, 1162, 3126, 1015, 2933, 1080, 670, 84, 464, 2089, 77, 2212, 2176, 907, 2144, 0, 3154, 434, 1968, 595, 925, 528, 2723, 3280, 2320, 1695, 1416, 1417, 108, 323, 63, 1844, 3093, 3046, 2207, 589, 559, 1796, 398, 1353, 1165, 541, 1077, 3031, 2214, 2996, 1319, 1165, 3234, 314, 2919, 1640, 2902, 2728, 2417, 88, 2767, 2489, 1858, 1018, 2053, 2488, 2590, 1529, 435, 2852, 729, 2773, 631, 600, 617, 1453, 67, 2476, 2860, 766, 501, 1928, 3306, 627, 1836, 1299, 541, 895, 3231, 349, 707, 930, 3171, 3042, 665, 1251, 386, 401, 1477, 23, 1228, 3248, 2701, 367, 257, 770, 2355, 1768, 579, 1770, 2650, 1493, 2320, 1601, 2444, 85, 3111, 2765, 1307, 2171, 2011, 1943, 2579, 1452, 2333, 160, 1135, 2521, 3088, 37, 2580, 1930, 2562, 829, 3163, 1858, 484, 164, 1064, 1096, 1464, 433, 191, 825, 3113, 3302, 1319, 2396, 2207, 58, 928, 2013, 3285, 584, 195, 865, 15, 226, 684, 1682, 1719, 1654, 2586, 2770, 1448, 512, 765, 897, 2104, 97, 998, 388, 2420, 738, 1211, 832, 52, 2238, 106, 647, 1218, 919, 2603, 2248, 466, 1148, 2173, 1074, 2444, 1762, 182, 1699, 2719, 936, 1378, 130, 264, 1318, 1767, 1893, 509, 1188, 2071, 3324, 3004, 1495, 2285, 2404, 443, 3299, 2540, 1820, 850, 2103, 2631, 2649, 1442, 975, 2949, 3076, 228, 1771, 1818, 2757, 1159, 1906, 1323, 1513, 2314, 230, 497, 1377, 1822, 201, 2583, 1980, 1806, 133, 751]
]


tti = [
    [624, 1861, 596, 315, 370, 2420, 2218, 3273, 3270, 2344, 473, 106, 176, 2998, 2182, 58, 273, 148, 1550, 1786, 826, 143, 2751, 2756, 2911, 2799, 85, 133, 1834, 1205, 2560, 1062, 1640, 1341, 1310, 2508, 2085, 1430, 3127, 3142, 2820, 1606, 3220, 678, 407, 510, 1382, 2431, 645, 2007, 2270, 2048, 1485, 515, 1216, 2332, 2872, 2299, 1308, 1239, 1231, 466, 3202, 2184, 2679, 937, 2197, 872, 2719, 3150, 1375, 1711, 246, 939, 1402, 2305, 2157, 969, 1547, 898, 2914, 3170, 2216, 616, 353, 3073, 1979, 2882, 2519, 312, 663, 1949, 2730, 1031, 1589, 1922, 2513, 2698, 206, 562, 2302, 2744, 3010, 528, 2466, 50, 3306, 2148, 656, 1822, 1802, 1539, 2576, 2513, 2086, 538, 130, 3094, 2218, 2733, 1615, 205, 2849, 645, 1225, 219, 3064, 1369, 1735, 2039, 1961, 10, 1184, 3290, 1052, 2686, 889, 2783, 1241, 893, 370, 1284, 2610, 2624, 1049, 696, 2255, 1915, 541, 1746, 907, 1449, 1538, 1073, 1165, 2298, 937, 3143, 956, 678, 837, 3143, 2565, 2620, 1060, 2831, 1589, 386, 2994, 2990, 1013, 487, 2063, 2220, 1352, 2656, 2848, 1299, 226, 1363, 1677, 1085, 1459, 1068, 220, 1504, 2023, 3101, 405, 3314, 1669, 1869, 2968, 3317, 2503, 2395, 434, 2270, 3029, 1218, 3023, 1581, 1719, 287, 3242, 1578, 1832, 2454, 489, 1225, 1122, 1410, 725, 238, 2178, 471, 854, 918, 558, 1430, 3322, 873, 17, 284, 1849, 184, 3306, 2209, 1657, 1646, 2672, 1778, 1100, 1927, 1528, 3287, 308, 3271, 626, 1721, 1464, 1109, 2640, 789, 504, 3219, 439, 310, 2845, 1868, 2954, 160, 2475, 2765, 1727, 2364, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [32, 430, 780, 2518, 3312, 174, 1678, 1763, 2022, 2875, 2435, 1397, 2083, 203, 1384, 603, 2365, 2873, 1218, 2350, 1879, 2595, 796, 1325, 1635, 19, 1396, 3213, 1350, 1638, 3183, 2262, 2424, 1374, 97, 3040, 424, 1123, 960, 3184, 868, 1456, 980, 1883, 1471, 457, 908, 2962, 2500, 2660, 3201, 1582, 2249, 758, 3156, 2005, 743, 2820, 2343, 1706, 1573, 2037, 62, 1028, 82, 2775, 1188, 6, 992, 1006, 2521, 2705, 2103, 23, 2862, 2952, 371, 456, 2242, 994, 1753, 2219, 2571, 3320, 3232, 2008, 1851, 1652, 129, 2157, 370, 996, 456, 2032, 1245, 3203, 802, 1885, 2072, 668, 110, 2347, 1356, 1186, 1527, 1064, 833, 393, 609, 2312, 2406, 2404, 2633, 891, 932, 1312, 3158, 2262, 2342, 1252, 2859, 3047, 1401, 3001, 3230, 1745, 1654, 313, 3285, 2359, 210, 2757, 2694, 2474, 1170, 117, 2253, 1197, 446, 1365, 798, 1808, 345, 2109, 1429, 1011, 282, 1586, 1637, 2977, 1719, 471, 2446, 1248, 1448, 1088, 1799, 530, 1934, 2997, 1138, 446, 3266, 3027, 2068, 2876, 2376, 2176, 2651, 1407, 195, 182, 2731, 581, 1590, 1141, 1871, 464, 3093, 2460, 3042, 2620, 1217, 612, 1246, 1671, 2006, 1229, 689, 2440, 276, 2423, 2841, 844, 1790, 60, 721, 1883, 3093, 2138, 345, 1891, 1298, 140, 1966, 1263, 431, 991, 722, 1225, 735, 1079, 2307, 1849, 1249, 143, 727, 1794, 929, 3142, 630, 784, 820, 1943, 770, 1204, 1918, 1640, 371, 2578, 2232, 1539, 2337, 1440, 1488, 2033, 2921, 1166, 2527, 2590, 1241, 2591, 2656, 2781, 1505, 3328, 1870, 358, 1347, 433, 1775, 913, 2874, 609, 1200, 2278, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
]
tt = [[1028, 1252, 299, 711, 3213, 231, 1392, 1871, 1674, 3008, 2209, 2522, 2680, 2677, 2357, 2699, 1282, 1951, 3023, 2985, 3196, 513, 883, 2321, 293, 706, 1143, 966, 2808, 342, 547, 3158, 2275, 1505, 579, 1571, 426, 1801, 1161, 2146, 2085, 1152, 610, 1245, 1204, 200, 1978, 2063, 2407, 1962, 368, 2435, 974, 1638, 2174, 2220, 1061, 53, 2667, 1465, 3159, 2859, 2757, 269, 2813, 498, 13, 1778, 1001, 452, 2628, 1389, 2838, 1739, 1072, 447, 1825, 380, 2826, 1266, 490, 2875, 151, 2722, 987, 944, 1233, 608, 74, 514, 260, 2592, 2833, 2232, 2255, 819, 3009, 2951, 1321, 2505, 250, 1533, 136, 1382, 2142, 1064, 709, 1234, 910, 2020, 2926, 1191, 488, 3009, 2711, 929, 769, 2323, 1392, 3030, 1743, 2365, 1770, 2407, 2765, 1065, 353, 2234, 2965, 1844, 51, 2876, 2292, 768, 282, 2163, 675, 765, 2706, 3157, 3213, 1091, 1611, 311, 85, 2427, 2712, 1469, 1126, 1468, 1857, 1939, 2235, 1661, 2154, 1097, 498, 1102, 636, 1245, 1699, 1102, 1985, 1158, 1917, 588, 2255, 3154, 195, 1042, 1050, 909, 91, 2633, 8, 193, 2814, 2076, 415, 1840, 266, 2449, 1486, 223, 21, 1112, 1903, 1673, 3292, 2344, 1960, 2887, 707, 2541, 133, 3028, 2977, 368, 274, 86, 3209, 620, 3024, 3311, 945, 423, 1567, 1354, 2150, 2765, 440, 2707, 2112, 1203, 3204, 968, 596, 360, 23, 1801, 650, 734, 2226, 3114, 464, 986, 709, 801, 1172, 2669, 134, 1350, 105, 2257, 2688, 571, 1361, 630, 2269, 936, 2924, 696, 252, 1876, 3135, 1654, 1086, 2602, 2617, 602, 2007, 2739, 2733, 2912, 1330, 2102, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [3211, 495, 1285, 1118, 1103, 1439, 2551, 365, 2947, 1258, 1216, 2963, 2514, 1124, 3219, 2978, 1058, 17, 86, 73, 2434, 626, 1226, 1564, 837, 138, 678, 1260, 2096, 1034, 2619, 2062, 2713, 343, 1931, 2106, 101, 2725, 3118, 1575, 2625, 1289, 2212, 1587, 2274, 2268, 813, 313, 3265, 2675, 472, 2905, 2318, 950, 846, 721, 3294, 2085, 723, 3280, 2314, 603, 1852, 2035, 946, 2459, 1445, 394, 3000, 1700, 1315, 2301, 1608, 2620, 1514, 766, 2169, 3312, 2968, 912, 818, 348, 2379, 2738, 1398, 918, 1705, 3063, 1813, 1825, 3213, 2153, 3312, 2494, 1859, 1713, 1620, 2828, 682, 1698, 1675, 3205, 2490, 204, 403, 1070, 2546, 2504, 43, 3126, 1531, 290, 902, 1916, 2389, 1820, 2087, 2062, 1767, 1209, 1317, 1456, 2116, 2874, 157, 2512, 975, 2799, 2659, 664, 474, 1277, 469, 448, 263, 1025, 1471, 2036, 436, 3081, 2467, 3320, 2681, 2002, 2845, 3138, 1873, 2058, 2078, 1298, 3024, 968, 3048, 2056, 2983, 2646, 2729, 2623, 1607, 392, 381, 436, 2521, 2362, 1529, 214, 2890, 1963, 2084, 2510, 2818, 3074, 1789, 2643, 1211, 578, 799, 1618, 38, 1748, 18, 1158, 1130, 240, 815, 3201, 3006, 1918, 3077, 2654, 1479, 428, 135, 1049, 2138, 611, 2959, 1587, 38, 1687, 2681, 3222, 3120, 316, 1489, 3041, 2780, 715, 1915, 2765, 1659, 2055, 1688, 464, 1012, 513, 24, 1291, 2192, 2146, 1422, 438, 2802, 2198, 1738, 1386, 1666, 2275, 2169, 1729, 92, 1191, 329, 1348, 1171, 1450, 3169, 1110, 1709, 2517, 2706, 1473, 193, 2853, 68, 1044, 1843, 2425, 1899, 692, 1153, 2251, 2302, 43, 2233, 2003, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
ty = [[-4795, -3830, -2821, -1542, -2497, -3267, -3063, -1585, -4482, -1698, -6294, -1904, -5884, -3452, -4860, -586, -4443, -3096, -1967, -1286, -953, -23, 515, -15, -3628, 2762, -1724, 3122, -5334, -298, -4442, -6, -578, 4885, -2392, 1661, -3355, -321, -1391, 2151, 344, 1137, 710, -1893, -2475, 2195, 289, 1369, -1593, -839, -4281, 2737, -2000, 1089, 658, 3145, -1533, -2062, -3461, -2114, -661, -618, 1911, 1590, -717, 3886, -427, 1444, -117, 1630, -1571, -796, -3853, 1773, -6405, 3355, -3207, 4470, -2919, 1118, -2265, -2505, -3895, -2127, -1872, -2305, -2624, 241, 104, 2058, -2712, -1232, 589, -843, 2851, 1353, -1248, 1894, 616, 1652, -936, -614, -1576, -1600, -1578, -590, 1374, -3208, 2475, -2744, 4057, 258, 1471, -1435, 3453, 1029, -825, -2311, -111, -579, -3385, 1734, -567, -288, -569, -983, 405, -1207, 1284, -4081, 3872, -4075, 457, -815, -905, -2297, 3595, -621, 621, -1463, -1788, 557, -584, 1163, -405, 2454, 1527, 2674, 2803, -699, 4719, 423, 1129, -1875, -211, -3029, 3199, -615, 2015, -1429, 3316, -699, 86, -245, 135, -4251, -1337, -3293, 3648, -3918, 5414, -1142, 2002, -1594, 752, 454, 682, -3351, 1580, -6549, 165, -3016, -1839, -1660, -3354, -1022, -574, -3112, -1431, 1015, -4653, -1857, 5881, -1262, 5427, -1250, 1757, 1057, 4535, 3219, 2764, 3082, 1298, 3406, 1280, 2044, 210, -992, 2066, 481, 3116, -1805, -238, -663, 1204, -2029, 2043, 1359, 1773, 667, -1124, 2135, -376, -905, -1216, 1119, 1658, 4399, 1502, 6046, -376, 3652, 1811, 3614, 1053, 2590, 4621, 2621, 1459, -113, 5576, -384, 2730, 1350, 1717, 3697, 4125, 2741, 5832, 822, 3140, 728, 4289, 3393, 6879, 3085, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1076, -1903, -1920, -1361, -861, -2071, -3267, -2233, -1011, -1688, -4029, -4240, -1195, -4869, -2593, -5243, -2382, -1562, -1670, -2706, -2124, 2652, -764, -380, 551, -2147, -865, -541, -2530, -750, 688, -862, 2725, -3470, 1145, -4138, 1569, -3428, -1579, -5592, 620, -5349, 3626, -2649, 3392, -3507, 726, -4963, 1500, -7037, 3394, -5885, -808, -4202, 446, -7036, 1381, -2576, -1379, -2448, 3779, -2635, 2391, -5533, 335, -2752, 993, -4264, -516, -1269, 2384, -503, -1120, -3508, -1298, -288, 673, -4175, 1757, -4089, -1973, -1426, -2819, -3926, -301, -1218, 1573, -418, -2276, -1225, -2188, 379, -4135, 1937, -4641, 1225, 3343, 730, 377, 1062, 1855, 2548, -523, 136, 1011, 2191, -1551, 4043, -814, 188, 2510, -818, 3617, 1851, 1927, 4631, -629, 271, 2197, 619, -1124, 2906, 562, 10, -535, 2565, 1361, 667, -451, 2568, -1461, 3520, -187, 3856, 723, 2700, 3074, 4263, 4296, 1889, 2116, 1406, -870, 494, 1931, 3015, 739, 1587, -3634, 2663, -636, 471, 3303, 1518, 1441, 862, 1656, 2330, -1032, 3786, -4180, -457, -1396, -473, -3033, -1298, -1551, -1940, -2317, -481, -683, -397, -708, -713, 516, 871, 1135, -467, 3443, -435, -148, 692, -2194, 2190, 1482, -2577, 414, -69, -918, -2135, -838, -4503, -347, 4250, -2071, 1954, -3324, 3087, -218, 2981, -1799, 3950, 1217, 3694, 1382, -399, -112, 1987, 3384, -439, 962, -195, 3083, -2902, 6303, 28, -1690, 594, -618, 586, 979, -431, 2965, -121, -3658, 3822, -2052, 3188, 1434, 1044, -1120, 1802, -3527, 3134, -3197, 890, -3438, 5486, -1346, 4850, 667, 1227, 3997, 4475, 4272, 5611, 1276, 5271, -811, 4456, 237, 4482, -1481, 4267, -1317, 5163, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]
yk = [[-1094, 1056, 549, -1496, 1586, 388, 1444, 887, 579, 1375, 1220, 710, -166, -906, -560, 1536, 120, -1424, 202, -1497, 877, -1572, -1305, -360, -464, -64, 56, 1004, 845, 1291, -1137, -1357, -1196, 1626, 727, -1232, -733, 1493, 541, 251, 1103, 1537, 39, -1567, 169, -1575, -184, -145, -637, 436, -1091, -978, 1596, 769, -115, -1603, 544, -1214, 1, -1362, -576, -257, 304, -352, -366, 643, -1614, 56, 1592, -313, -892, -95, 378, 846, -409, 374, -191, 760, 966, -1069, 232, -439, 718, 1215, 1356, 185, -473, 109, -496, -1272, -516, -604, 828, 1600, -870, 723, 1416, 443, -511, 417, -383, 1009, 576, -627, 14, 804, -664, 83, -244, 143, 176, 459, 526, 1239, -784, 1689, 1372, 1422, -956, 1110, -646, -138, 357, 297, -2, 1038, 1023, 604, -1106, 366, 872, 1456, 208, 145, -550, -544, -452, -1403, -642, 1576, -1549, -1441, 413, -786, 408, -849, 1253, 1525, 12, 373, 1493, 782, 1597, 142, -621, -1207, -1261, 89, -590, -1247, 550, 848, 332, -583, -349, 1709, -1565, -1070, 1670, -165, 520, -946, -702, 877, -1142, -1366, -415, -1178, 1376, -435, -405, -1446, 655, 1441, -139, -1305, 1630, -1470, 658, 291, 1632, 914, 320, -1054, 492, -1358, -1158, -331, -1315, 992, 1528, 1627, 824, -847, -1174, 591, 434, -759, -1047, -1214, -272, -1477, -391, -413, 993, -128, 1276, 361, -955, 1048, 604, 556, -1582, -700, 44, 489, 1142, -1307, -939, 186, 612, -239, 1712, -217, 1315, 699, -771, -4, -739, -192, -1527, -120, -806, 906, 1456, -1585, 91, -805, 159, -627, 647, 853, 436, -1015, 1426, -602, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [1514, 1297, 640, -1094, -265, 67, 1326, -1407, -1391, 674, 880, 251, -1062, 1444, -950, -281, -757, 1066, 1606, 1073, -52, 758, 731, -637, 1205, -1526, 290, 585, 81, -730, -521, 559, 1584, -1634, -996, 284, -1569, 485, 1687, -1374, 65, -1447, -948, 105, 1643, -564, -565, 1250, 1614, -1343, 1258, -113, -482, 937, 1662, 513, 1619, 506, -1365, -199, -1494, -220, -845, 1122, -762, 741, -677, 803, 990, -1470, 747, 1122, -1356, 1254, -401, -706, 883, -920, -570, -1493, 907, -1162, 508, -1121, -960, 1495, 1039, 446, 1524, 1336, 389, 695, 17, -601, 302, -590, -391, 714, -787, 1709, 909, 1468, 340, 1410, 439, 1221, 610, -1075, 1521, -258, -1078, 17, 1404, 132, -738, -1364, 1187, 863, 759, -223, -104, 579, -263, -1495, -283, -1255, 1488, 1097, -236, 19, -948, 49, 1236, -750, 502, -1531, 964, -633, 1158, 1192, 255, 49, 1278, 1568, 1335, -467, -1144, 1663, 233, 874, 919, 1436, 1102, 382, -357, -812, 473, -1260, 971, -1468, 458, 572, 162, 341, -1510, 1433, 1366, -1020, -373, -297, -491, 62, 417, -81, 1059, 1539, 158, 1355, -224, 1370, -1111, 1003, -1161, 593, 306, -1379, -666, -1048, -90, 1648, -942, -565, 1137, 1209, 787, -685, -519, -314, -934, 827, -1124, 1566, -287, 682, 358, 639, 1609, -1190, 782, 548, 759, 47, -1087, 912, 54, -1015, -1306, -1127, 1650, -132, 1505, -1230, 15, 122, 467, 1136, 311, -40, -122, -541, 324, 80, -1536, 876, 1522, 1470, 629, -244, 1035, -547, -794, 1562, -1467, -602, -1579, -709, 975, -1174, 494, 523, 442, -725, -128, 1337, 491, -1417, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]


key_generation()


# error = [
#     generate_noise_polynomial(noise_seed, nonce.next())
#     for _
#     in range(PARAMETERS.k)
# ]

# print(ntt2(secret_key[0]))


# print(ntt(secret_key[0][0:256]))
# print(ntt_recursive(secret_key[0][0:256], 1))

# secret_key = [reduce(ntt(polynomial), PARAMETERS.q) for polynomial in secret_key]
# error = [ntt(polynomial) for polynomial in error]

# print(secret_key)
# print(error)
# # secret_key_vector_of_polynomials = [ntt(x) for x in secret_key_vector_of_polynomials]
# # secret_key_vector_of_polynomials = [[barrett_reduce(y) for y in x] for x in secret_key_vector_of_polynomials]

# # error_vector_of_polynomials = [ntt(x) for x in error_vector_of_polynomials]

# # for i in range(0, KYBER_PARAMS.k):
# #     temp = polyvec_pointwise_acc_mont(a[i], skpv, params_k)
# #     pkpv[i] = poly_to_mont(temp)
